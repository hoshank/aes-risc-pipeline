\documentclass[preprint]{iacrtrans}

\usepackage{paper}

\title{An exploration of ISEs for AES on RISC-V}
\keywords{AES, ISE, RISC-V}

\ifbool{anonymous}{%
\author{}
\institute{}
}{%
\author{
Ben Marshall\inst{1}                \and
Dan Page\inst{1}                    \and
Markku-Juhani O. Saarinen\inst{2}   \and
(Andy/ Richard / Barry / Claire?)
}
\institute{
    Department of Computer Science, University of Bristol \\ \email{{ben.marshall,daniel.page}@bristol.ac.uk}
    \and
    PQShield, Oxford \\ \email{mjos@pqshield.com}
}
}%

\begin{document}

% =============================================================================

\maketitle

\begin{abstract}
Secure, efficient execution of AES represents an imperative, and therefore 
well studied requirement in many use-cases.  Use of an
Instruction Set Extension (ISE)
is one approach to addressing this requirement, and, as a result, ISEs for 
AES exist in many ISAs.  
However, RISC-V is a (relatively) new ISA that lacks such an ISE: this gap
motivates our work.  In specific terms, and set against on-going effort to 
standardise cryptographic ISEs for RISC-V, we
1) survey the state-of-the-art wrt. ISEs for AES,
2) implement and evaluate five different ISEs for AES,
   one of which is novel,
3) explore how the B 
   (or bit manipulation) 
   extension
   to RISC-V can be harnessed for efficient implementation of AES-GCM,
   and
4) demonstrate how an ISE for AES can hardened against DPA-style attacks.
\end{abstract}

% =============================================================================

\section{Introduction}
\label{sec:intro}
\input{tex/intro.tex}

% =============================================================================

\section{Background}
\label{sec:bg}

% -----------------------------------------------------------------------------

\subsection{AES  specification}
\label{sec:bg:aes_spec}
\input{tex/bg-aes_spec.tex}

% -----------------------------------------------------------------------------

\subsection{AES implementation}
\label{sec:bg:aes_impl}

\subsubsection{Representation}
\label{sec:bg:aes_impl_rep}
\input{tex/bg-aes_impl_rep.tex}

\subsubsection{Hardware-only implementations}
\label{sec:bg:aes_impl_hw}
\input{tex/bg-aes_impl_hw.tex}
\subsubsection{Software-only implementations}
\label{sec:bg:aes_impl_sw}
\input{tex/bg-aes_impl_sw.tex}
\subsubsection{Hybrid        implementations}
\label{sec:bg:aes_impl_ise}
\input{tex/bg-aes_impl_ise.tex}

\subsubsection{Security}
\label{sec:bg:aes_impl_sec}
\input{tex/bg-aes_impl_sec.tex}

% -----------------------------------------------------------------------------

\subsection{AES  use-cases}
\label{sec:bg:aes_usage}
\input{tex/bg-aes_usage.tex}

% -----------------------------------------------------------------------------

\subsection{RISC-V}
\label{sec:bg:riscv}
\input{tex/bg-riscv.tex}

% =============================================================================

\section{Exploring ISEs for AES}
\label{sec:ise}

% -----------------------------------------------------------------------------

\subsection{Design}

\input{tex/body-ise_intro.tex}

\subsubsection{Variant 1 (\ISE{1}): \AESFUNC{SubBytes} $+$ \AESFUNC{MixColumn} $+$ explicit \AESFUNC{ShiftRows}}
\label{sec:ise:design:v1}
\input{tex/body-ise_design_v1.tex}
\subsubsection{Variant 2 (\ISE{2}): \AESFUNC{SubBytes} $+$ \AESFUNC{MixColumn} $+$ implicit \AESFUNC{ShiftRows}}
\label{sec:ise:design:v2}
\input{tex/body-ise_design_v2.tex}
\subsubsection{Variant 3 (\ISE{3}): T-tables}
\label{sec:ise:design:v3}
\input{tex/body-ise_design_v3.tex}
\subsubsection{Variant 4 (\ISE{4}): SPARC-like}
\label{sec:ise:design:v4}
\input{tex/body-ise_design_v4.tex}
\subsubsection{Variant 5 (\ISE{5}): tiled}
\label{sec:ise:design:v5}
\input{tex/body-ise_design_v5.tex}

% -----------------------------------------------------------------------------

\subsection{Implementation}
\label{sec:ise:imp}
\input{tex/body-ise_implement.tex}

% -----------------------------------------------------------------------------

\subsection{Evaluation}

\subsubsection{Hardware}
\label{sec:ise:eval:hw}
\input{tex/body-ise_eval_hw.tex}

\subsubsection{Software}
\label{sec:ise:eval:sw}
\input{tex/body-ise_eval_sw.tex}

\subsubsection{Discussion}
\label{sec:ise:eval:discuss}
\input{tex/body-ise_eval_discuss.tex}

% =============================================================================

\section{Using ISEs to implement AES-GCM}
\label{sec:gcm}
\input{tex/body-gcm.tex}

% =============================================================================

\section{Hardening an ISE for AES against DPA attack}
\label{sec:sca}
\input{tex/body-sca.tex}

% =============================================================================

\section{Conclusion}
\label{sec:outro}
\input{tex/outro.tex}

% ============================================================================

\ifbool{anonymous}{}{%
\section*{Acknowledgements}

We would like to thank the anonymous reviewers for their helpful and 
constructive comments.
This work has been supported in part by EPSRC via grant EP/R012288/1, 
under the RISE (\url{http://www.ukrise.org}) programme.
}%

% =============================================================================

\bibliographystyle{alpha}
\bibliography{paper}

% =============================================================================

\appendix

\newpage
\section{\ISE{1} Mnemonics and pseudo-code}
\label{sec:pseudo:v1}
\input{tex/appx-design_v1.tex}
\newpage
\section{\ISE{2} Mnemonics and pseudo-code}
\label{sec:pseudo:v2}
\input{tex/appx-design_v2.tex}
\newpage
\section{\ISE{3} Mnemonics and pseudo-code}
\label{sec:pseudo:v3}
\input{tex/appx-design_v3.tex}
\newpage
\section{\ISE{4} Mnemonics and pseudo-code}
\label{sec:pseudo:v4}
\input{tex/appx-design_v4.tex}
\newpage
\section{\ISE{5} Mnemonics and pseudo-code}
\label{sec:pseudo:v5}
\input{tex/appx-design_v5.tex}

\newpage
\section{Additional algorithms}
\label{sec:alg}
\input{tex/appx-alg.tex}

% =============================================================================

\end{document}
