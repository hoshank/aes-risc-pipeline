
\subsection{Variant 1: Column wise acceleration}

\begin{lstlisting}[language=pseudo]
saes.v1.encs(rs1):
    rd.8[i] =    AESSBox(rs1.8[i]) for i=0..3

saes.v1.decs(rs1):
    rd.8[i] = InvAESSBox(rs1.8[i]) for i=0..3

saes.v1.encm(rs1):
    rd.8[0] =    AESMixColumn({rs1.8[0],rs1.8[1],rs1.8[2],rs1.8[3])
    rd.8[1] =    AESMixColumn({rs1.8[0],rs1.8[1],rs1.8[2],rs1.8[3])
    rd.8[2] =    AESMixColumn({rs1.8[0],rs1.8[1],rs1.8[2],rs1.8[3])
    rd.8[3] =    AESMixColumn({rs1.8[0],rs1.8[1],rs1.8[2],rs1.8[3])

saes.v1.decm(rs1):
    rd.8[0] = InvAESMixColumn({rs1.8[0],rs1.8[1],rs1.8[2],rs1.8[3])
    rd.8[1] = InvAESMixColumn({rs1.8[0],rs1.8[1],rs1.8[2],rs1.8[3])
    rd.8[2] = InvAESMixColumn({rs1.8[0],rs1.8[1],rs1.8[2],rs1.8[3])
    rd.8[3] = InvAESMixColumn({rs1.8[0],rs1.8[1],rs1.8[2],rs1.8[3])
\end{lstlisting}


\subsection{Variant 2: Combined row/column acceleration}

\cite{TG:20}

\begin{lstlisting}[language=pseudo]
saes.v2.sub(rs1, rs2, mode):
    if(mode == enc)
        t0 =    AESSBox(rs1.8[0]), t1 =    AESSBox(rs2.8[1])
        t2 =    AESSBox(rs1.8[2]), t3 =    AESSBox(rs2.8[3])
    else
        t0 = InvAESSBox(rs1.8[0]), t1 = InvAESSBox(rs2.8[1])
        t2 = InvAESSBox(rs1.8[2]), t3 = InvAESSBox(rs2.8[3])
    rd.32 = {t3, t2, t1, t0} 

saes.v2.mix(rs1, rs2, mode):
    t0 = rs1.8[0], t1 = rs1.8[1]
    t2 = rs2.8[2], t3 = rs2.8[3]
    if(mode == enc)
        rd.32 =    AESMixColumns(t3,t2,t1,t0)
    else
        rd.32 = InvAESMixColumns(t3,t2,t1,t0)
\end{lstlisting}


\subsection{Variant 3: TTables based acceleration}

\cite{MJS:20}

\begin{lstlisting}[language=pseudo]
saes.v3.encs(rs1, rs2, bs):                 // SubBytes Only
    t0.8  = rs1.8[bs]
    x.8   = AESSBox(t0)
    u.32  = {0, 0, 0, x}
    rd.32 = ROTL32(u, 8*bs) ^ rs2.32

saes.v3.encsm(rs1, rs2, bs):                // SubBytes & MixColumns
    t0.8  = rs1.8[bs]
    x.8   = AESSBox(t0)
    u.32  = {GFMUL(x,3) , x, x, GFMUL(x,2)}
    rd.32 = ROTL32(u, 8*bs) ^ rs2.32

saes.v3.decs(rs1, rs2, bs):                 // InvSubBytes Only
    t0.8  = rs1.8[bs]
    x.8   = InvAESSBox(t0)
    u.32  = {0, 0, 0, x}
    rd.32 = ROTL32(u, 8*bs) ^ rs2.32

saes.v3.decsm(rs1, rs2, bs):                // InvSubBytes & InvMixColumns
    t0.8  = rs1.8[bs]
    x.8   = InvAESSBox(t0)
    u.32  = {GFMUL(x,11),GFMUL(x,13),GFMUL(9),GFMUL(14)}
    rd.32 = ROTL32(u, 8*bs) ^ rs2.32
\end{lstlisting}

\subsection{Variant 4: 64-bit datapath utilisation}

\begin{lstlisting}[language=pseudo]
round_consts.8 = [0x01, 0x02, 0x04, 0x08, 0x10, 0x20, 0x40, 0x80, 0x1b, 0x36]

saes64.ks1(rs1,enc_rcon):      // KeySchedule: SubBytes, Rotate, Round Const
    temp.32   = rs1.32[1]
    rcon      = 0x0
    if(enc_rcon != 0xA):
        temp.32 = ROTR32(temp.32, 8)
        rcon    = round_consts.8[enc_rcon]
    temp.8[i] = AESSBox(temp.8[i])  for i=0..3
    temp.8[0] = temp.8[i  ] ^ rcon
    rd.64     = {temp.32, temp.32}

saes64.ks2(rs1,rs2):           // KeySchedule: XOR
    rd.32[0]  = rs1.32[1] ^ rs2.32[0]
    rd.32[1]  = rs1.32[1] ^ rs2.32[0] ^ rs2.32[1]

saes64.enc(rs1, rs2, mix, hi): // SubBytes, ShiftRows, MixColumns
    t1.128    = AESShiftRows(rs2 || rs1)
    t2.64     = t1.64[1] if hi else t1.64[0]
    t3.8[i]   = AESSBox(t2.8[i]) for i=0..7
    rd.32[0]  = AESMixColumn(t3.32[0]) if mix else t3.32[0]
    rd.32[1]  = AESMixColumn(t3.32[1]) if mix else t3.32[1]

saes64.dec(rs1, rs2, mix, hi): // InvSubBytes, InvShiftRows, InvMixColumns
    t1.128    = InvAESShiftRows(rs2 || rs1)
    t2.64     = t1.64[1] if hi else t1.64[0]
    t3.8[i]   = InvAESSBox(t2.8[i]) for i=0..7
    rd.32[0]  = InvAESMixColumn(t3.32[0]) if mix else t3.32[0]
    rd.32[1]  = InvAESMixColumn(t3.32[1]) if mix else t3.32[1]

saes64.imix(rs1):              // Inverse MixColumns
    rd.32[0]  = InvAESMixColumn(rs1.32[0])
    rd.32[1]  = InvAESMixColumn(rs1.32[1])
\end{lstlisting}


\subsection{Variant 5: Tiling}

\begin{lstlisting}[language=pseudo]
saes.v5.srsub(rs1, rs2, enc, hi):
    if(enc):
        tmp.8[0] = rs2.8[2] if hi else rs1.8[2]
        tmp.8[1] = rs2.8[1] if hi else rs1.8[0]
        tmp.8[2] = rs2.8[0] if hi else rs1.8[1]
        tmp.8[3] = rs1.8[3] if hi else rs2.8[3]
        tmp.8[i] =    AESSBox[tmp.8[i]] for i=0..3
    else:
        tmp.8[0] = rs2.8[2] if hi else rs1.8[2]
        tmp.8[1] = rs1.8[1] if hi else rs1.8[0]
        tmp.8[2] = rs2.8[0] if hi else rs2.8[1]
        tmp.8[3] = rs2.8[3] if hi else rs1.8[3]
        tmp.8[i] = InvAESSBox[tmp.8[i]] for i=0..3
    if(hi):
        rd.32    = {tmp.8[2],tmp.8[3],tmp.8[0],tmp.8[1]}
    else:
        rd.32    = {tmp.8[1],tmp.8[3],tmp.8[0],tmp.8[2]}

saes.v5.sub(rs1):
    rd.8[i] = AESSBox[rs1.8[i]] for i = 0..3

saes.v5.mix(rs1, rs2, enc):
    col0.8[3] = rs1.8[2]
    col0.8[2] = rs1.8[3]
    col0.8[1] = rs2.8[2]
    col0.8[0] = rs2.8[3]
    col1.8[3] = rs1.8[0]
    col1.8[2] = rs1.8[1]
    col1.8[1] = rs2.8[0]
    col1.8[0] = rs2.8[1]
    if(enc):
        n0 =    AESMixColumn(       col0   )
        n1 =    AESMixColumn(ROTL32(col0,8))
        n2 =    AESMixColumn(       col1   )
        n3 =    AESMixColumn(ROTL32(col1,8))
    else:
        n0 = InvAESMixColumn(       col0   )
        n1 = InvAESMixColumn(ROTL32(col0,8))
        n2 = InvAESMixColumn(       col1   )
        n3 = InvAESMixColumn(ROTL32(col1,8))
    rd.32 = {n2, n3, n0, n1}
\end{lstlisting}
