% =============================================================================

\REFSEC{sec:pseudo:v2} shows the mnemonics and pseudo-code functions
for \ISE{2}.
Here we reproduce the instructions proposed in~\cite[Section 4.3]{TilGro:06}.
We continue to store the AES column-wise in four $32$-bit words.
By using two source registers however,
the \AESFUNC{ShiftRows} transformation can be implicitly performed by selecting
appropriate bytes from each source word, as shown in
\REFFIG{fig:design:fu_block:v2}.
Executing $4$  {\tt v2.encs}/{\tt v2.encm} instructions each hence
performs the entire \AESFUNC{SubBytes}, \AESFUNC{ShiftRows} and \AESFUNC{MixColumns} steps.
The {\tt v2.encs} instruction can be used for the KeySchedule by
making {\tt rs1} equal to {\tt rs2}.

A single encryption round using this variant requires $16$ instructions
in total:
four {\tt saes.v2.sub.enc} instructions to perform \AESFUNC{SubBytes} and part of
shift rows,
four {\tt saes.v2.mix.enc} instructions to perform \AESFUNC{MixColumns} and the
remainder of \AESFUNC{ShiftRows},
four load-word instructions to fetch the round key
and
four {\tt xor} instructions to perform \AESFUNC{AddRoundKey}.
\REFFIG{fig:round:v2} shows an example AES encrypt round function
using this variant.

Because the final round does not include \AESFUNC{MixColumns}, we must
complete the final \AESFUNC{ShiftRows} operation with an additional
$12$ {\tt and}/{\tt or} instructions.

% =============================================================================
