% =============================================================================


\REFSEC{sec:pseudo:v3} shows the mnemonics and pseudo-code functions
for \ISE{3}.
These instructions are based on
\cite{NadIkeKur:04,BBFR:06} and \cite{Saarinen:20},
which implement a T-tables based representation of AES \cite{DaeRij:02}.
The AES state is stored column-wise in $4$ $32$-bit words, and
each instruction selects a single byte of {\tt rs2} to operate on
using the $2$-bit {\tt bs} immediate.
This byte is used as the input to a standard T-table lookup operation,
but the table entry is calculated in hardware.
\REFFIG{fig:design:fu_block:v3} shows the data-path for these instructions.
The result of the T-table lookup is then xor'd with {\tt rs1} to
accumulate the results of the round transformation.

These instructions require only one SBox implementation to be implemented,
which is a clear advantage in resource constrained applications.
While the previous designs could be implemented with a single SBox, they
would not

We also note that \cite{Saarinen:20} improves on \cite{BBFR:06}
by using an extra source register and allowing the AddRoundKey step to be
performed implicitly, thus saving four instructions per round.

A single encryption round using this variant requires
$4$ load-word instructions to fetch the round key and
$16$ {\tt saes.v3.encs[m]} instructions to perform AddRoundKey,
SubBytes, ShiftRows and (optionally) MixColumns.
\REFFIG{fig:round:v3} shows an example AES encrypt round function
using this variant.

% =============================================================================
